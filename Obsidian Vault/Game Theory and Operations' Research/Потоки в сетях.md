> [!math|{"type":"definition","number":"auto","setAsNoteMathLink":false,"title":"Сеть","label":"","_index":0}] Определение 1 (Сеть).
> S = (V, E)
> $x\in V, xy\in E: \forall x\in V A(x) = \{y\in V|xy\in E\}, B(x) = \{y\in V|yx\in E\}$
> В сети выделены s - источник и t - сток.

> [!math|{"type":"definition","number":"auto","setAsNoteMathLink":false,"title":"Поток","label":"","_index":1}] Определение 2 (Поток).
> Поток из s в t - функция $f:E\to \mathbb R_+$:
> 1) $0\leqslant f(e)\leqslant c(e)$, где $c(e)$ - пропускная способность $e\in E$ - ==условие допустимости==
> 2) $\sum\limits_{y\in A(x)} f(xy) - \sum\limits_{y\in B(x)} f(yx) = \begin{cases}v, \text{при }x=s\\ -v, \text{при }x=t\\ 0\end{cases}$ ==условие баланса==
> $f(e), e\in E$ - дуговые потоки, v - величина потока

^44f239

> [!math|{"type":"definition","number":"auto","setAsNoteMathLink":false,"title":"Максимальный поток","label":"-","_index":2}] Определение 3 (Максимальный поток).
> Поток - максимальный, если v - максимально

# Задача поиска максимального потока
$x_{ij} \sim f(xy), \forall xy\in E$
$c_{ij}\sim c(xy)$
$$\begin{cases}
F = v\to\max\\
\sum\limits_{j\in A(i)}x_{ij} - \sum\limits_{j\in B(i)}x_{ji} = \begin{cases}v, \text{при }i=s\\ -v, \text{при }i=t\\ 0\end{cases} \\
0\leqslant x_{ij}\leqslant c_{ij}
\end{cases}$$

^197da0

> [!math|{"type":"definition","number":"auto","setAsNoteMathLink":false,"title":"Допустимая дуга","label":"-","_index":3}] Определение 4 (Допустимая дуга).
> Дуга e в сети S называется допустимой дугой из x в y относительно потока f из s в t, если 
> - либо $e=xy\in E$ и $f(e)<c(e)$ ==прямая дуга==
> - либо $e = yx\in E$ и $f(e)>0$ ==обратная дуга==

^6dde08

> [!math|{"type":"definition","number":"auto","setAsNoteMathLink":false,"title":"Увеличивающий путь","label":"-","_index":4}] Определение 5 (Увеличивающий путь).
> Увеличивающий путь для потока $f$ из s в t называется последовательность вершин $P = (x_{0}=s, x_{1}, ..., x_{k-1}, x_{k}=t)$ такая, что $\forall i$
> - либо $e_{i} = x_{i-1}x_{i}\in E$
> - либо $e_{i}= x_{i}x_{i-1}\in E$,
> причем $e_i$ - допустимая дуга из $x_{i-1}$ в $x_i$ относительно потока f

^7dbb20

> [!math|{"type":"claim","number":"auto","setAsNoteMathLink":false,"title":"об увеличении потока","label":"--","_index":5}] Утверждение 6 (об увеличении потока).
> Если для потока f из s в t существует увеличивающий путь, то данный поток может быть увеличен.


> [!danger] Доказательство
> -  f - некоторый поток, P - увеличивающий путь
> - Рассмотрим прямые дуги и обратные дуги
> - минимальная разность $c(x, y) - f(x, y)$, и $f(y, x)$ > 0
> - получили поток больше


# Метод расстановки пометок (алгоритм Форда-Фалкерсона)

Начинаем с нулевого потока
- Поиск увеличивающего пути
- Найден увеличивающий путь - возможно увеличение потока
Каждая итерация $O(n^2)$
Число итераций $\leqslant v^{2}\implies O(v^*n^2)$ псевдополиномиальный 

> [!math|{"type":"theorem","number":"auto","setAsNoteMathLink":false,"title":"о целочисленности","label":"-","_index":6}] Теорема 7 (о целочисленности).
> Если пропускные способности всех дуг в сети S целочисленны, то существует максимальный целочисленный поток, который может быть найден методом расстановки пометок за конечное число итераций.

^348128

> [!danger] доказательство
> Начинаем с нулевого потока
> $\delta\geqslant 1$ дискретная целочисленная величина
> Целевая функция ограничена $\sum\limits_{y\in A(s)} c(s, y)$, число итераций ограничено $v^*$ 

# Потоки и разрезы
> [!math|{"type":"definition","number":"auto","setAsNoteMathLink":false,"title":"Разрез","label":"","_index":7}] Определение 8 (Разрез).
> В сети $S = (V, E), X\subset V, \overline {X} = V\setminus X$. Тогда разрезом называют $(X, \overline{X})$ - множество дуг $e = xy:x\in X, y\in \overline X$

^6802c0

> [!math|{"type":"definition","number":"auto","setAsNoteMathLink":false,"title":"Разрез разделяет s и t","label":"--s--t","_index":8}] Определение 9 (Разрез разделяет s и t).
> Говорят, что разрез $(X, \overline X)$ разделяет s и t, если $s\in X, t\in \overline X$

> [!math|{"type":"definition","number":"auto","setAsNoteMathLink":false,"title":"Пропускная способность разреза","label":"--","_index":9}] Определение 10 (Пропускная способность разреза).
> $$c(X, \overline X) = \sum\limits_{e\in (X, \overline X)} c(e)$$

> [!math|{"type":"definition","number":"auto","setAsNoteMathLink":false,"title":"Минимальный разрез, разделяющий s и t","label":"---s--t","_index":10}] Определение 11 (Минимальный разрез, разделяющий s и t).
> Разрез с min $c(X, \overline X)$ среди всех таких разрезов

^5e50d5

> [!math|{"type":"definition","number":"auto","setAsNoteMathLink":false,"title":"Поток через разрез","label":"--","_index":11}] Определение 12 (Поток через разрез).
> Величина $f(X, \overline X) = \sum\limits_{e\in (X, \overline X)} f(e)$

> [!math|{"type":"lemma","number":"auto","setAsNoteMathLink":false,"title":"о потоках и разрезах","label":"---","_index":12}] Лемма 13 (о потоках и разрезах).
> Для любого потока f из s в t и любого разреза $(X, \overline X)$, разделяющего s и t верно
> $$v(f) = f(X, \overline X) - f(\overline X, X)$$

^4ef6a5


> [!danger] Доказательство
> Для любого $x\in V$
> $$\sum\limits_{y\in A(x)} f(x, y) - \sum\limits_{y\in B(x)} f(y,x)=\begin{cases}v, x = s\\-v, x=t \\0
\end{cases}$$
   Просуммируем все равенства для $x\in X$
   Справа будет v
   >$$\sum\limits_{x\in X}\sum\limits_{y\in A(x)} f(x, y) - \sum\limits_{x\in X} \sum\limits_{y\in B(x)} f(y,x) = v$$
   >Все слагаемые $f(x, y)$, где $y\in X$ взаимно уничтожатся
   >Если $y\in \overline X$, то получится $f(X, \overline{X}) - f(\overline X, X) = v$
   >
   >
   
> [!math|{"type":"corollary","number":"auto","setAsNoteMathLink":false,"_index":13}] Следствие 14.
> Величина любого потока из s в t не превышает пропускной способности любого разреза

> [!danger] Доказательство
> $$v = f(X, \overline X) - f(\overline X, X)\leqslant f(X, \overline X)\leqslant C(X, \overline X)$$


> [!math|{"type":"lemma","number":"auto","setAsNoteMathLink":false,"title":"о существовании максимального потока","label":"---","_index":14}] Лемма 15 (о существовании максимального потока).
> В любой конечной сети существует максимальный поток

> [!math|{"type":"theorem","number":"auto","setAsNoteMathLink":false,"title":"Форд-Фалкерсон","label":"-","_index":15}] Теорема 16 (Форд-Фалкерсон).
> В любой конечной сети величина максимального потока равна пропускной способности минимального разреза.

^94e906


> [!danger] доказательство
> Имеем максимальный поток $v^{*}= v(f^*)$
> 
> Построим разрез, разделяющий s и t
> X  формируем по правилам:
> 1) $s\in X$
> 2) если $x\in X$, $f^{*}(x, y)< c(x, y)$, то у включаем
> 3) если $x\in X$, $f^*(y, x)>0$, то y включаем
> Остались только пустые обратные и насыщенные прямые ребра, т.е пропускная способность разреза равна величине максимального потока
> Заметим, что t не может попасть в Х
> 	Действительно, пусть $t\in X$, тогда существует увеличивающий путь, т.е. поток не максимален, противоречие
> 	
> $c(X, \overline X) = f^*(X, \overline X)$
> из леммы 1 $\forall f\; \forall (Y, \overline Y) \quad C(X,\overline X)\geqslant v(f)$
> $C(Y,\overline Y)\geqslant v^{*}=c(X, \overline X)$
> получили минимальный разрез


# Критерии максимального потока

> [!math|{"type":"theorem","number":"auto","setAsNoteMathLink":false,"title":"критерий 1","label":"-1","_index":16}] Теорема 17 (критерий 1).
> $f - \max$ $\Leftrightarrow$ не существует пути, увеличивающего поток

^a28be0

> [!danger] доказательство
> $\Rightarrow$ очевидно
> $\Leftarrow$ аналогично построим разрез, как в теореме, в котором $c(X, \overline X) = v(t)$
> $\forall f' \neq f\quad v(f')\leqslant c(X, \overline X) = v(f)\to \max$
> 

> [!math|{"type":"theorem","number":"auto","setAsNoteMathLink":false,"title":"критерий 2","label":"-","_index":17}] Теорема 18 (критерий 2).
> $f - \max\Leftrightarrow$ для некоторого $(X, \overline X)$ он насыщает все прямые дуги и оставляет пустыми все дуги $(\overline X, X)$

^8d268f


> [!danger] доказательство
> $v(f) = f(X, \overline X) - f(\overline X, X) \leqslant c(X, \overline X)$
> f - max => $v(f^*) = c(X, \overline X)$
> $f(X, \overline X) = v(f), f(\overline X, X) = 0$

[[Задача о спросе и предложении]]

